---
title: "HW1Q2"
output:
  pdf_document: default
  html_document: default
date: "2024-02-03"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
```

**2. Wrangling the Olympics**

In this part, we want to investigate some statistical facts about all Olympics medalists from 1896 till recent. This data set contains information including competitors' basic information, the categories of sports they play, and the event in which they won the medal, etc. 

```{r echo=FALSE}

athletics_f = read.csv('data/olympics_top20.csv')

```

A. What is the 95th percentile of heights for female competitors across all Athletics events ? 

To answer this question, first we need to filter the female players who play athletics sports from the original data set. Then, we can simply summarize the 95% quantile of heights and get the result: The 95% quantile of heights for female Athletics players is 183cm. 
```{r echo=FALSE}

athletics_f %>% 
  filter(sex == "F" & sport == "Athletics")%>%
  summarise(percentile_95=quantile(height, 0.95))

```

B. Which single women's event had the greatest variability in competitor's heights across the entire history of the Olympics, as measured by the standard deviation?

Standard deviation reflects the variability of data. Thus, we may calculate the standard deviation of height grouped by each event, then find the event with the highest standard deviation. The event with most various players' heights is Rowing Women's Coxed Fours, with a standard deviation of 10.9. 

```{r echo=FALSE}

athletics_f %>%
  filter(sex == "F") %>%
  group_by(event) %>%
  summarize(mean = mean(height), sd = sd(height)) %>%
  slice_max(sd)

```

C. How has the average age of Olympic swimmers changed over time? Does the trend look different for male swimmers relative to female swimmers? 

See in the following plot:

```{r echo=FALSE}

swimming <- athletics_f %>%
  filter(sport == "Swimming") %>%
  group_by(year, sex) %>%
  summarize(avg_age = mean(age))

plot <- ggplot(swimming, aes(x = year, y = avg_age, color = sex)) +
  geom_line() +
  labs(
    title = "Average Age of Olympic Swimmers Over Time",
    x = "Year",
    y = "Average Age",
     ) +
  theme_minimal()

print(plot)

```

In the plot, the x-axis is the year while the y-axis is the average age of swimmers. The two lines, with the blue one tracks the values of average age of male swimmers, red one tracks that of female swimmers, tells us about how average age of swimmers change from 1900s till recent. We can see that generally, the female swimmers are younger than male swimmers. 

The average age of male swimmers reached a peach in 1925, which was 32. However, that age dramatically dropped in the following years to as low as below 20. About the growing average age of swimmers before 1925, we can make a hypothesis that this pattern may be resulted by two reasons: 1. this sport was still young in Olympic, so not many professional young swimmers were trained as successors. 2. due to the ongoing wars and the unstable economic environment in the postwar period, young males were not able to professionally prepare for Olympics games. The sudden drop in age of swimmers indicates a turning point in which the older swimmers retired and younger ones joined the game. 

The line of female competitors is shorter than that of males. That echoes with the fact that female athletics were not accepted in international sports events until that time. Starting to join Olympics in around 1920s, the average age of female swimmers has always been younger than that of male swimmers except for the year of 2000. In the year of 2000, the average age of male and female competitors intersected at between 22-23 years old. 

Generally speaking, the average age of both female and male swimmers slowly grows after 1950, with very slight fluctuations. This indicates that the selection and preparation for international professional swimmers has settled into a steady state. 